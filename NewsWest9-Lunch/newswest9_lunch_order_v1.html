<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NewsWest 9 Lunch Orders</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0f0f0f;
    --surface: #1a1a1a;
    --surface2: #242424;
    --border: #2e2e2e;
    --accent: #1a6bbd;
    --accent2: #0f4a8a;
    --text: #f0ede8;
    --muted: #888;
    --green: #4caf7d;
    --radius: 12px;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    padding-bottom: 120px;
  }

  /* HEADER */
  header {
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    padding: 16px 20px;
    position: sticky;
    top: 0;
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .logo-img {
    display: flex;
    align-items: center;
  }
  .cart-btn {
    background: var(--accent);
    color: #000;
    border: none;
    border-radius: 50px;
    padding: 8px 18px;
    font-family: 'DM Sans', sans-serif;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: transform 0.15s, background 0.15s;
  }
  .cart-btn:hover { transform: scale(1.05); background: #2d7dd2; }
  .cart-count {
    background: var(--accent2);
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    font-size: 11px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
  }

  /* STEPS */
  .steps {
    display: flex;
    gap: 0;
    padding: 0 20px;
    background: var(--surface);
    border-bottom: 1px solid var(--border);
    overflow-x: auto;
    scrollbar-width: none;
  }
  .step {
    padding: 12px 20px;
    font-size: 13px;
    font-weight: 500;
    color: var(--muted);
    white-space: nowrap;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
    cursor: default;
  }
  .step.active { color: var(--accent); border-bottom-color: var(--accent); }
  .step.done { color: var(--green); }

  /* MAIN CONTENT */
  main { max-width: 700px; margin: 0 auto; padding: 24px 20px; }

  /* SCREEN 1 ‚Äî NAME */
  .welcome-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 52px;
    line-height: 1;
    letter-spacing: 2px;
    margin-bottom: 8px;
  }
  .welcome-title span { color: var(--accent); }
  .welcome-sub {
    color: var(--muted);
    font-size: 15px;
    margin-bottom: 36px;
  }
  .field-label {
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 8px;
  }
  .text-input {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 14px 16px;
    font-family: 'DM Sans', sans-serif;
    font-size: 16px;
    color: var(--text);
    outline: none;
    transition: border-color 0.2s;
  }
  .text-input:focus { border-color: var(--accent); }
  .text-input::placeholder { color: #555; }
  .btn-primary {
    background: var(--accent);
    color: #000;
    border: none;
    border-radius: var(--radius);
    padding: 14px 28px;
    font-family: 'DM Sans', sans-serif;
    font-weight: 700;
    font-size: 15px;
    cursor: pointer;
    width: 100%;
    margin-top: 16px;
    transition: background 0.2s, transform 0.15s;
  }
  .btn-primary:hover { background: #2d7dd2; transform: translateY(-1px); }
  .btn-primary:disabled { background: #444; color: #666; cursor: not-allowed; transform: none; }

  /* SCREEN 2 ‚Äî RESTAURANT */
  .restaurant-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 14px;
    margin-top: 8px;
  }
  .restaurant-card {
    background: var(--surface);
    border: 2px solid var(--border);
    border-radius: var(--radius);
    padding: 22px 24px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .restaurant-card:hover { border-color: var(--accent); background: var(--surface2); }
  .restaurant-card.selected { border-color: var(--accent); background: rgba(245,166,35,0.08); }
  .restaurant-name {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 26px;
    letter-spacing: 1px;
  }
  .restaurant-desc { font-size: 13px; color: var(--muted); margin-top: 2px; }
  .restaurant-arrow { color: var(--accent); font-size: 22px; }

  /* SCREEN 3 ‚Äî MENU */
  .section-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 32px;
    letter-spacing: 1px;
    margin-bottom: 4px;
  }
  .section-sub { font-size: 13px; color: var(--muted); margin-bottom: 20px; }
  .cat-tabs {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }
  .cat-tab {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 50px;
    padding: 7px 16px;
    font-size: 13px;
    font-weight: 500;
    color: var(--muted);
    cursor: pointer;
    transition: all 0.15s;
    white-space: nowrap;
  }
  .cat-tab:hover { border-color: var(--accent); color: var(--text); }
  .cat-tab.active { background: var(--accent); border-color: var(--accent); color: #000; font-weight: 700; }
  .group-label {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--accent2);
    margin: 20px 0 10px;
  }
  .menu-items { display: flex; flex-direction: column; gap: 10px; }
  .menu-item {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 14px 16px;
    transition: border-color 0.2s;
  }
  .menu-item:hover { border-color: #444; }
  .item-top { display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; }
  .item-name { font-weight: 600; font-size: 15px; }
  .item-details { font-size: 12px; color: var(--muted); margin-top: 3px; line-height: 1.4; }
  .item-actions { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }
  .qty-btn {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    width: 28px;
    height: 28px;
    border-radius: 6px;
    font-size: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.15s;
    font-weight: 600;
  }
  .qty-btn:hover { background: var(--border); }
  .qty-display {
    font-weight: 700;
    font-size: 15px;
    min-width: 20px;
    text-align: center;
  }
  .add-btn {
    background: var(--accent);
    color: #000;
    border: none;
    border-radius: 8px;
    padding: 7px 14px;
    font-family: 'DM Sans', sans-serif;
    font-weight: 700;
    font-size: 13px;
    cursor: pointer;
    transition: background 0.15s;
    white-space: nowrap;
  }
  .add-btn:hover { background: #2d7dd2; }
  .add-btn.added { background: var(--green); color: white; }
  .variant-select {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 6px 10px;
    font-family: 'DM Sans', sans-serif;
    font-size: 13px;
    color: var(--text);
    margin-top: 10px;
    width: 100%;
    outline: none;
    cursor: pointer;
  }
  .variant-select:focus { border-color: var(--accent); }

  /* SCREEN 4 ‚Äî CART */
  .cart-list { display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px; }
  .cart-item {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 14px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
  }
  .cart-item-info { flex: 1; }
  .cart-item-name { font-weight: 600; font-size: 14px; }
  .cart-item-variant { font-size: 12px; color: var(--accent); margin-top: 2px; }
  .cart-item-qty { font-size: 12px; color: var(--muted); }
  .remove-btn {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--muted);
    border-radius: 6px;
    width: 28px;
    height: 28px;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.15s;
    flex-shrink: 0;
  }
  .remove-btn:hover { border-color: var(--accent2); color: var(--accent2); }
  .empty-cart {
    text-align: center;
    padding: 40px 20px;
    color: var(--muted);
    font-size: 14px;
  }
  .notes-area {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 12px 14px;
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    color: var(--text);
    resize: vertical;
    min-height: 80px;
    outline: none;
    margin-bottom: 16px;
    transition: border-color 0.2s;
  }
  .notes-area:focus { border-color: var(--accent); }
  .notes-area::placeholder { color: #555; }
  .btn-secondary {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text);
    border-radius: var(--radius);
    padding: 14px 28px;
    font-family: 'DM Sans', sans-serif;
    font-weight: 600;
    font-size: 15px;
    cursor: pointer;
    width: 100%;
    margin-bottom: 10px;
    transition: border-color 0.2s;
  }
  .btn-secondary:hover { border-color: var(--accent); }

  /* SCREEN 5 ‚Äî CONFIRM */
  .confirm-icon {
    font-size: 64px;
    margin-bottom: 16px;
    display: block;
  }
  .confirm-title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 48px;
    letter-spacing: 2px;
    color: var(--green);
    margin-bottom: 8px;
  }
  .confirm-sub { color: var(--muted); font-size: 15px; margin-bottom: 32px; }
  .order-summary {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px;
    margin-bottom: 24px;
    text-align: left;
  }
  .order-summary-label {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 12px;
  }
  .order-summary-line { font-size: 14px; padding: 5px 0; border-bottom: 1px solid var(--border); }
  .order-summary-line:last-child { border-bottom: none; }
  .summary-name { color: var(--accent); font-weight: 600; }
  .summary-variant { color: var(--muted); font-size: 12px; }

  /* LOADING */
  .loading {
    display: none;
    text-align: center;
    padding: 20px;
    color: var(--muted);
    font-size: 14px;
  }
  .spinner {
    width: 32px;
    height: 32px;
    border: 3px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 0 auto 12px;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* NOTICE */
  .notice {
    background: rgba(245,166,35,0.1);
    border: 1px solid rgba(245,166,35,0.3);
    border-radius: var(--radius);
    padding: 12px 16px;
    font-size: 13px;
    color: var(--accent);
    margin-bottom: 20px;
  }

  /* SCREEN TRANSITIONS */
  .screen { display: none; animation: fadeIn 0.2s ease; }
  .screen.active { display: block; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } }

  @media (max-width: 480px) {
    .welcome-title { font-size: 40px; }
    .section-title { font-size: 26px; }
    main { padding: 20px 16px; }
  }
</style>
</head>
<body>

<header>
  <div class="logo-img">
    <img src="NewsWest9 new logo-white.png" alt="NewsWest 9" style="height:40px; width:auto; display:block;">
  </div>
  <button class="cart-btn" onclick="goToCart()">
    üõí Cart <span class="cart-count" id="cartCount">0</span>
  </button>
</header>

<div class="steps">
  <div class="step active" id="step1">1. Your Name</div>
  <div class="step" id="step2">2. Browse Menus</div>
  <div class="step" id="step3">3. Cart</div>
  <div class="step" id="step4">4. Done</div>
</div>

<main>

  <div class="screen active" id="screenName">
    <div class="welcome-title">What's for<br><span>Lunch?</span></div>
    <div class="welcome-sub">NewsWest 9 lunch orders ‚Äî Rosa's, Walk-On's, or Bubba's 33</div>
    <div class="field-label">Your Name</div>
    <input class="text-input" id="nameInput" type="text" placeholder="First and last name" maxlength="60"
      onkeydown="if(event.key==='Enter') startOrder()">
    <button class="btn-primary" onclick="startOrder()">Start Order ‚Üí</button>
  </div>

  <div class="screen" id="screenRestaurant">
    <div class="section-title">Browse Menus</div>
    <div class="section-sub" id="greetingSub"></div>
    <div class="restaurant-grid" id="restaurantGrid"></div>
  </div>

  <div class="screen" id="screenMenu">
    <div class="section-title" id="menuTitle"></div>
    <div class="section-sub">Tap items to add to your cart</div>
    <div class="cat-tabs" id="catTabs"></div>
    <div id="menuContent"></div>
    <button class="btn-primary" style="margin-top:24px" onclick="goToCart()">Review Cart ‚Üí</button>
  </div>

  <div class="screen" id="screenCart">
    <div class="section-title">Your Order</div>
    <div class="section-sub" id="cartRestLabel"></div>
    <div class="cart-list" id="cartList"></div>
    <div class="field-label">Special Instructions (optional)</div>
    <textarea class="notes-area" id="notesInput" placeholder="e.g. no onions, extra salsa, allergies..."></textarea>
    <div class="loading" id="submitLoading">
      <div class="spinner"></div>
      Sending your order...
    </div>
    <button class="btn-primary" id="submitBtn" onclick="submitOrder()">Submit Order</button>
    <button class="btn-secondary" onclick="buildRestaurantScreen(); showScreen('screenRestaurant', 2)">‚Üê Back to Restaurants</button>
  </div>

  <div class="screen" id="screenDone">
    <div style="text-align:center; padding-top:20px;">
      <span class="confirm-icon">‚úÖ</span>
      <div class="confirm-title">Order Received!</div>
      <div class="confirm-sub">Your order has been sent to the admin.<br>Come grab your food when it arrives.</div>
    </div>
    <div class="order-summary" id="orderSummary"></div>
    <button class="btn-primary" onclick="newOrder()">Place Another Order</button>
  </div>

</main>

<script>
// ‚îÄ‚îÄ‚îÄ CONFIGURATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// THIS IS YOUR NEW POWER AUTOMATE URL
const POWER_AUTOMATE_URL = "https://defaultccd8a79b7268413b878971f8b6f4c0.df.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/87acc1fe78784b9d8272fdeee0b7bad0/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=HAr3ZFJINx0qastbljjvsBrEoCd0PiSTuEJxR8AC5f8";

// ‚îÄ‚îÄ‚îÄ MENU DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const RESTAURANTS = [
  {
    id: "rosas",
    name: "Rosa's Cafe",
    desc: "Tex-Mex ‚Ä¢ Burritos, Enchiladas, Fajitas",
    categories: {
      "Dinners": [
        { name: "Beef Burrito Plate", details: "3 Burritos" },
        { name: "Taco Plate", details: "3 Tacos", variants: ["Crispy Beef","Soft Beef","Crispy Chicken","Soft Chicken","Combo"] },
        { name: "Mexican Dinner", details: "1 Taco, 1 Enchilada" },
        { name: "Cheese Enchilada Plate (2)", variants: ["Red Sauce","Green Sauce","Sour Cream Sauce","Queso"] },
        { name: "Cheese Enchilada Plate (2) with Chili Con Carne" },
        { name: "Deluxe Mexican Plate", details: "Guacamole, Taco, Enchilada, Tamale, Tostada" },
        { name: "Chicken Fajita Plate", details: "With guacamole & 3 flour tortillas" },
        { name: "Fajita Carbon Plate (2)", details: "With guacamole", variants: ["2 Chicken","2 Beef","1 Chicken / 1 Beef"] },
        { name: "Beef Fajita Plate", details: "With guacamole & 3 flour tortillas" },
        { name: "Smothered Burrito Dinner" },
        { name: "Chile Verde Plate" },
        { name: "Tamale Dinner", details: "3 Tamales", variants: ["Chicken","Pork"] },
        { name: "Chicken Enchilada Plate (2)", details: "With sour cream sauce" },
        { name: "Beef Enchilada Plate (2)" },
        { name: "Tres Amigos Dinner", details: "3 Enchiladas: Beef, Chicken & Cheese" }
      ],
      "Individual Items": [
        { name: "Fajita", group: "Fajitas", variants: ["Beef","Chicken"] },
        { name: "Fajita with Guacamole", group: "Fajitas", variants: ["Beef","Chicken"] },
        { name: "Fajita with Queso", group: "Fajitas", variants: ["Beef","Chicken"] },
        { name: "Beef Burrito", group: "Burritos" },
        { name: "Bean & Cheese Burrito", group: "Burritos" },
        { name: "Combo Burrito", group: "Burritos" },
        { name: "Tostada", group: "Tostadas", variants: ["Beef","Chicken"] },
        { name: "Guacamole Tostada", group: "Tostadas" },
        { name: "Bean & Cheese Tostada", group: "Tostadas" },
        { name: "Crispy Taco", group: "Tacos", variants: ["Beef","Chicken"] },
        { name: "Soft Taco", group: "Tacos", variants: ["Beef","Chicken"] },
        { name: "Guacamole Salad", group: "Salads" },
        { name: "Taco Salad", group: "Salads", variants: ["Beef","Shredded Chicken"] },
        { name: "Fiesta Salad", group: "Salads", variants: ["Chicken","Beef","Combo"] },
        { name: "Fajita Salad", group: "Salads", variants: ["Chicken","Beef","Combo"] },
        { name: "Nacho Salad", group: "Salads", variants: ["Beef","Shredded Chicken"] },
        { name: "Queso Nachos", group: "Nachos" },
        { name: "Combination Nachos", group: "Nachos" },
        { name: "Fajita Nachos", group: "Nachos", variants: ["Chicken","Beef","Combo"] },
        { name: "Tamale", group: "Tamales", variants: ["Pork","Chicken"] },
        { name: "3 Tamales", group: "Tamales", variants: ["Pork","Chicken"] },
        { name: "Chips & Salsa", group: "Chips & Dips", variants: ["Regular (4 oz)","Large (8 oz)","Pint (16 oz)"] },
        { name: "Chips & Queso", group: "Chips & Dips", variants: ["Regular (4 oz)","Large (8 oz)","Pint (16 oz)"] },
        { name: "Chips & Guacamole", group: "Chips & Dips", variants: ["Regular (4 oz)","Large (8 oz)","Pint (16 oz)"] },
        { name: "Queso Supreme", group: "Chips & Dips" }
      ],
      "Desserts": [
        { name: "Chocolate Cake", variants: ["Piece"] },
        { name: "Carrot Cake", variants: ["Piece"] },
        { name: "Sopapillas", variants: ["Small (4)","Large (8)"] }
      ],
      "Drinks": [
        { name: "Iced Tea", variants: ["Sweet - Regular","Sweet - Large","Unsweet - Regular","Unsweet - Large","Peach - Regular","Peach - Large"] },
        { name: "Soft Drink", variants: ["Coke - Regular","Coke - Large","Diet Coke - Regular","Diet Coke - Large","Dr Pepper - Regular","Dr Pepper - Large","Sprite - Regular","Sprite - Large","Barq's Root Beer - Regular","Barq's Root Beer - Large"] },
        { name: "Orange Juice" },
        { name: "Milk", variants: ["Regular","Chocolate"] },
        { name: "Coffee" }
      ]
    }
  },
  {
    id: "walkons",
    name: "Walk-On's Sports Bistreaux",
    desc: "Cajun Sports Bar ‚Ä¢ Seafood, Burgers, Wings",
    categories: {
      "Starters": [
        { name: "Boneless Wings (14)", details: "Choice of sauce", variants: ["Buffalo","Lemon Pepper","Louisiana Kick","Hot Honey","Sweet Chili"] },
        { name: "Bone-In Wings (6 pc)", variants: ["Buffalo","Lemon Pepper","Louisiana Kick","Hot Honey","Sweet Chili"] },
        { name: "Bone-In Wings (12 pc)", variants: ["Buffalo","Lemon Pepper","Louisiana Kick","Hot Honey","Sweet Chili"] },
        { name: "Bone-In Wings (18 pc)", variants: ["Buffalo","Lemon Pepper","Louisiana Kick","Hot Honey","Sweet Chili"] },
        { name: "Fried Alligator", details: "Farm-raised white tail meat, hand-battered" },
        { name: "Waffle Cheese Fries", details: "Jack, cheddar, bacon, banana peppers", variants: ["Full","Half"] },
        { name: "Cheeseburger Sliders (3)" },
        { name: "Pepper Jack Boudin", details: "Cajun seasoned pork, rice, pepper jack" },
        { name: "Spinach & Artichoke Dip", details: "With tortilla chips" },
        { name: "Boom Boom Shrimp", details: "Fried shrimp, boom boom sauce" },
        { name: "Mozzarella Logs", details: "Hand-battered with panko breadcrumbs" },
        { name: "Devils on Horseback", details: "Grilled jumbo shrimp, cream cheese, pickled jalapenos, wrapped in bacon, hot honey" }
      ],
      "Cajun Classics": [
        { name: "Red Beans", variants: ["Cup","Bowl"] },
        { name: "Crawfish Etouffee", variants: ["Cup","Bowl"] },
        { name: "Chicken & Sausage Gumbo", variants: ["Cup","Bowl"] }
      ],
      "Salads": [
        { name: "Cypress Cobb", details: "Fried chicken, mixed greens, bacon, avocado, egg, tomatoes, blue cheese, ranch" },
        { name: "Zydeco", details: "Sweet chili shrimp, mixed greens, cabbage, candied pecans, jalapenos, tortilla strips" },
        { name: "Caesar", details: "Romaine, parmesan, croutons" },
        { name: "Chicken Berry Pecan", details: "Grilled chicken, mixed greens, strawberries, blueberries, apples, candied pecans" },
        { name: "Ahi Tuna Salad", details: "Seared ahi tuna, mixed greens, cabbage, avocado, edamame, carrots, sweet chili glaze" }
      ],
      "Signature Entrees": [
        { name: "Cajun Ribeye", details: "Blackened 12 oz. ribeye, garlic butter, garlic mashed potatoes, broccoli" },
        { name: "Cajundillas", details: "Chipotle tortilla, grilled chicken, andouille sausage, boudin, caramelized onions, red beans & rice" },
        { name: "Blackened Chicken Alfredo", details: "Blackened chicken, alfredo sauce, parmesan, linguine" },
        { name: "Uncle B's Chicken Tenders (5)", details: "Hand-battered tenderloins, waffle fries", variants: ["Fried","Grilled"] },
        { name: "Lemon Butter Chicken", details: "Grilled chicken breasts, lemon butter, cheddar grits, broccoli" }
      ],
      "Seafood": [
        { name: "Louisiana Platter", details: "Hand-battered jumbo shrimp and catfish, crawfish etouffee, waffle fries, hush puppies" },
        { name: "Voodoo Shrimp & Grits", details: "Bacon-wrapped jalapeno stuffed shrimp, sweet chili glaze, cheddar grits" },
        { name: "Fried Jumbo Shrimp", details: "Hand-battered, seasoned waffle fries and hush puppies" },
        { name: "Bayou Pasta", details: "Creamy crawfish linguine topped with blackened jumbo shrimp" },
        { name: "Fried Catfish", details: "Hand-battered catfish strips, seasoned waffle fries, hush puppies" },
        { name: "Catfish Orleans", details: "Catfish fillets over rice, topped with crawfish etouffee and hand-battered shrimp", variants: ["Blackened","Fried"] },
        { name: "Mango Tuna Bowl", details: "Seared ahi tuna, sweet chili glaze, sriracha aioli, rice, avocado, mango salsa" },
        { name: "Mardi Gras Salmon", details: "Hot honey-glazed grilled salmon, mango salsa, broccoli" },
        { name: "Ragin' Redfish", details: "Blackened redfish over rice, broccoli", variants: ["Lemon Butter","Mango Salsa","Crawfish Cream Sauce"] }
      ],
      "Tacos & Wraps": [
        { name: "Boom Boom Shrimp Tacos", details: "Fried shrimp, boom boom sauce, cabbage, jack, tomato" },
        { name: "Redfish Tacos", details: "Blackened redfish, slaw, mango salsa, sriracha aioli" },
        { name: "Cali Wrap", details: "Sliced turkey, bacon, swiss, lettuce, avocado, tomato, garlic aioli" },
        { name: "Buffalo Chicken Wrap", details: "Shaved grilled chicken, bacon, tomato, cheddar, buffalo sauce" }
      ],
      "Sandwiches": [
        { name: "Chicken Avocado", details: "Grilled chicken, swiss, avocado, lettuce, tomato, honey mustard, wheat bun" },
        { name: "Buffalo Chicken", details: "Fried chicken, buffalo sauce, lettuce, tomato, ranch, brioche bun" },
        { name: "Warm Turkey Melt", details: "Sliced turkey, melted havarti, sriracha aioli, lettuce, tomato, wheat bun" },
        { name: "Grown-Up Grilled Cheese", details: "American, swiss, havarti, parmesan, bacon, marinara, toasted homestyle bread" },
        { name: "Black Jack Chicken", details: "Blackened chicken, jack, bacon, caramelized onions, lettuce, tomato, sriracha aioli" },
        { name: "Ribeye Sliders (2)", details: "Sliced blackened ribeye, swiss, caramelized onions, dijon horseradish, garlic aioli" },
        { name: "Seafood Po'boy", details: "Tomato, lettuce, pickles, mayo, poboy bread", variants: ["Boom Boom Shrimp - Full","Boom Boom Shrimp - Half","Fried Shrimp - Full","Fried Shrimp - Half","Fried Catfish - Full","Fried Catfish - Half"] }
      ],
      "Burgers": [
        { name: "Hangover Burger", details: "Sunny-side up egg, american, bacon" },
        { name: "Double Bacon Cheese Burger", details: "American, bacon, thousand island" },
        { name: "Classic Burger" },
        { name: "Scholarship Burger", details: "Smaller classic with american cheese" },
        { name: "Jalapeno Jack Burger", details: "Fried jalapenos, pepper jack, sriracha aioli" },
        { name: "Havarti Turkey Burger", details: "Caramelized onions, havarti, pepper jelly, spring mix, garlic aioli" },
        { name: "Hickory Burger", details: "BBQ sauce, cheddar, bacon, onion rings" }
      ],
      "Sides": [
        { name: "Onion Rings" }, { name: "Waffle Fries" }, { name: "Garlic Mashed Potatoes" },
        { name: "Sweet Potato Fries" }, { name: "Broccoli" }, { name: "Hush Puppies" },
        { name: "Side Salad" }, { name: "Cheddar Grits" }
      ],
      "Desserts": [
        { name: "Doughnut Bread Pudding", details: "Made with Krispy Kreme doughnuts" },
        { name: "Beignet Bites" },
        { name: "Chocolate Chip Cookie Sundae" }
      ],
      "Drinks": [
        { name: "Iced Tea", variants: ["Sweet","Unsweet"] },
        { name: "Soft Drink", variants: ["Coke","Diet Coke","Dr Pepper","Diet Dr Pepper","Sprite","Barq's Root Beer","Lemonade"] },
        { name: "Coffee" },
        { name: "Red Bull", details: "Ask for available flavors" }
      ]
    }
  },
  {
    id: "bubbas",
    name: "Bubba's 33",
    desc: "Sports Bar ‚Ä¢ Burgers, Pizza, Wings",
    categories: {
      "Starters": [
        { name: "Combo Appetizer", details: "Boneless Wings, Fried Cheese, and Crispy Fried Pickles" },
        { name: "Big O' Rings", details: "Sliced fresh, hand-battered and fried", variants: ["Half Order","Full Order"] },
        { name: "Garlic Knots", details: "Scratch-made pizza dough, garlic butter & parmesan" },
        { name: "Layered Cheese Fries", details: "Crispy seasoned fries, queso, melted cheese, bacon & green onions" },
        { name: "Crispy Fried Pickles", details: "Dill pickle chips breaded and golden-fried" },
        { name: "Crooked Fried Cheese", details: "Deep fried mozzarella cheese sticks" },
        { name: "Shotgun Shrimp", details: "Spicy creamy sauce on lightly hand-breaded shrimp" },
        { name: "Chorizo Queso", details: "Melted cheeses, chorizo, pico de gallo, jalapeno sauce, tortilla chips" },
        { name: "Poblano Spinach Dip", details: "Creamy spinach dip with roasted poblanos, parmesan, tortilla chips and garlic focaccia" },
        { name: "Bubba's Nachos", details: "Tortilla chips, chicken, chorizo, queso, melted cheeses, jalapeno sauce, sour cream, pico de gallo" }
      ],
      "Wings": [
        { name: "Traditional Wings (6)", variants: ["Honey Chipotle BBQ","Kickin' Teriyaki","Garlic Parmesan","Shotgun","Mild","Hot","Raspberry Chipotle","Habanero Heat","Cajun (dry)","Habanero Chipotle Fire (dry)"] },
        { name: "Traditional Wings (12)", variants: ["Honey Chipotle BBQ","Kickin' Teriyaki","Garlic Parmesan","Shotgun","Mild","Hot","Raspberry Chipotle","Habanero Heat","Cajun (dry)","Habanero Chipotle Fire (dry)"] },
        { name: "Traditional Wings (18)", variants: ["Honey Chipotle BBQ","Kickin' Teriyaki","Garlic Parmesan","Shotgun","Mild","Hot","Raspberry Chipotle","Habanero Heat","Cajun (dry)","Habanero Chipotle Fire (dry)"] },
        { name: "Boneless Wings (6)", variants: ["Honey Chipotle BBQ","Kickin' Teriyaki","Garlic Parmesan","Shotgun","Mild","Hot","Raspberry Chipotle","Habanero Heat","Cajun (dry)","Habanero Chipotle Fire (dry)"] },
        { name: "Boneless Wings (12)", variants: ["Honey Chipotle BBQ","Kickin' Teriyaki","Garlic Parmesan","Shotgun","Mild","Hot","Raspberry Chipotle","Habanero Heat","Cajun (dry)","Habanero Chipotle Fire (dry)"] },
        { name: "Boneless Wings (18)", variants: ["Honey Chipotle BBQ","Kickin' Teriyaki","Garlic Parmesan","Shotgun","Mild","Hot","Raspberry Chipotle","Habanero Heat","Cajun (dry)","Habanero Chipotle Fire (dry)"] }
      ],
      "Salads": [
        { name: "The Big Salad", details: "Fresh greens, egg, tomato, cheddar & jack, red onion, potato straws" },
        { name: "Italian Chopped Salad", details: "Salami, pepperoni, Canadian bacon, turkey, mozzarella & provolone, tomato, cucumber, red onion" },
        { name: "Grilled Chicken Salad", details: "Grilled chicken, fresh greens, egg, tomato, cheddar & jack, red onion, potato straws" },
        { name: "Strawberry Quinoa Salad", details: "Spring mix and quinoa, tomatoes, candied pecans, strawberries, dried cranberries, goat cheese" },
        { name: "Crispy Chicken Salad", details: "Tender fried chicken, greens, egg, tomato, cheddar & jack, red onion, potato straws" },
        { name: "Salmon Salad", details: "Seasoned salmon, fresh greens, egg, tomato, cheddar & jack, red onion, potato straws" }
      ],
      "Burgers": [
        { name: "Classic Cheeseburger", details: "Bubba sauce, american, lettuce, tomato, onion", variants: ["Single","Double"] },
        { name: "Wild Shroomin' Burger", details: "Sauteed mushrooms, garlic mayo, jack, lettuce, tomato, onion" },
        { name: "Spicy Habanero Burger", details: "Habanero heat sauce, charred jalapenos, fried jalapeno cream cheese, Bubba sauce" },
        { name: "Blackened Bleu Burger", details: "Cajun spiced, creamy bleu cheese sauce, bacon, lettuce, tomato, onion" },
        { name: "Patriot Burger", details: "BBQ sauce, cheddar, mayo, pickles, lettuce, tomato, hand-battered onion ring" },
        { name: "Bacon Guacamole Burger", details: "Bacon, guacamole, pepper jack, lettuce, tomato, onion" },
        { name: "Bacon Cheeseburger", details: "Bubba sauce, american, bacon, lettuce, tomato, onion" },
        { name: "Sunshine Burger", details: "American, fried egg, bacon, lettuce, tomato, onion" },
        { name: "Fire-Roasted Green Chile Burger", details: "Roasted red & green chilies, pickles, onion, american" }
      ],
      "Sandwiches": [
        { name: "Turkey & Bacon Sandwich", details: "Turkey, bacon, melted cheddar, dill pickles, honey mustard, focaccia bread" },
        { name: "Shotgun Shrimp Po' Boy", details: "Fried shrimp in spicy cream sauce, hoagie roll, lettuce, tomato, green onions" },
        { name: "Fried Fish Sandwich", details: "Atlantic Cod in Samuel Adams batter, hoagie roll, dill pickles, lettuce, tomato, tartar sauce" },
        { name: "Philly Cheese Steak", details: "Shaved sirloin, green peppers, mushrooms, caramelized onions, 4 types of cheese, toasted hoagie" },
        { name: "Monte Cristo Sandwich", details: "Roasted turkey, ham, american and jack cheese, wheat bread, tempura battered and deep fried" },
        { name: "Chicken Parmesan Sandwich", details: "Fried chicken breast, mozzarella, provolone, marinara, garlic mayo, toasted hoagie" },
        { name: "Bacon Avocado Sandwich", details: "Marinated chicken, pepper jack, bacon, avocado, lettuce, tomato, onion, focaccia" },
        { name: "Fried Chicken Sandwich", details: "Fried chicken, lettuce, tomato, onion, choice of wing sauce or dry seasoning" }
      ],
      "Dinners": [
        { name: "Signature Ribeye (14oz)", details: "Espresso rub, coffee glaze, choice of 2 sides" },
        { name: "Fish & Chips", details: "Atlantic Cod in Samuel Adams batter, tartar sauce, seasoned fries, coleslaw" },
        { name: "Crunchy Fried Shrimp", details: "Hand-breaded golden-fried, cocktail sauce, seasoned fries, coleslaw" },
        { name: "Chicken Tenders & Fried Shrimp Combo", details: "Choice of 2 sides" },
        { name: "Chicken Tender Dinner", details: "Hand-breaded golden-fried, BBQ, ranch or honey mustard, choice of 2 sides" },
        { name: "California Chicken", details: "Grilled chicken, avocado, pico de gallo, jack, honey lime sauce, over garden rice" },
        { name: "Southern Fried Chicken", details: "Hand-breaded, golden-fried, cream gravy, garlic mashed potatoes" },
        { name: "Grilled Ribeye (12oz)", details: "Hand-cut in-house, choice of 2 sides" },
        { name: "Seasoned Salmon", details: "Chili seasoned, honey lime sauce, over garden rice" }
      ],
      "Pastas": [
        { name: "Lasagna", details: "Italian sausage, ricotta, Bolognese, mozzarella, provolone, parmesan" },
        { name: "Chicken & Bacon Mac N' Cheese", details: "Grilled chicken, bacon, five cheeses, parmesan, breadcrumbs" },
        { name: "Creamy Chipotle Pasta", details: "Grilled chicken, sauteed shrimp, roasted peppers, onions, mushrooms, spicy chipotle cream sauce" }
      ],
      "Pizzas": [
        { name: "Cheese Pizza", variants: ["12\"","16\""] },
        { name: "Pepperoni Pizza", variants: ["12\"","16\""] },
        { name: "33 Deluxe Pizza", details: "Pepperoni, Italian sausage, red & green peppers, red onion, mushrooms, black olives", variants: ["12\"","16\""] },
        { name: "Fresh Veggie Pizza", details: "Red & green peppers, red onion, tomatoes, mushrooms, black olives", variants: ["12\"","16\""] },
        { name: "Meaty Meaty Pizza", details: "Bacon, Italian sausage, pepperoni", variants: ["12\"","16\""] },
        { name: "Hawaiian Pizza", details: "Canadian bacon, bacon, pineapple", variants: ["12\"","16\""] },
        { name: "BBQ Chicken Pizza", details: "Pepper jack, chicken, red onions, banana peppers, cilantro, honey chipotle BBQ sauce", variants: ["12\"","16\""] },
        { name: "Buffalo Classic Pizza", details: "Chicken, buffalo ranch, crumbled bleu cheese, hot sauce drizzle", variants: ["12\" Fried Chicken","12\" Grilled Chicken","16\""] },
        { name: "Albuquerque Turkey Pizza", details: "Ranch sauce, turkey, bacon, New Mexico green chiles, cheddar, sour cream lime drizzle", variants: ["12\"","16\""] },
        { name: "The Dickie V Pizza", details: "Italian sausage, cherry peppers, fresh basil, garlic buttered crust", variants: ["12\"","16\""] },
        { name: "Super Stromboli", details: "Pepperoni, salami, Italian sausage, Canadian bacon, cheese blend, pizza sauce baked in pizza dough" }
      ],
      "Sides": [
        { name: "Garlic Mashed Potatoes & Gravy" }, { name: "Cole Slaw" }, { name: "Seasoned Fries" },
        { name: "Fire Fries" }, { name: "Tater Tots" }, { name: "Garden Rice" },
        { name: "Steamed Broccoli" }, { name: "Cup of Chili" }, { name: "Mac N' Cheese" }, { name: "Side Salad" }
      ],
      "Desserts": [
        { name: "Chocolate Chip Cookie Sundae", details: "Scratch-made cookie, vanilla ice cream, chocolate sauce, whipped cream" },
        { name: "Bubba's Cheesecake", details: "NY-style with choice of topping", variants: ["Fresh Strawberry","Turtle (chocolate fudge, caramel, candied pecans)"] },
        { name: "Bubba's Oreo Brownie", details: "Chocolate brownie with Oreo pieces, vanilla ice cream, chocolate sauce, whipped cream" }
      ],
      "Drinks": [
        { name: "Slow-Brewed Iced Tea", variants: ["Sweet","Unsweet"] },
        { name: "Flavored Tea / Lemonade", variants: ["Bubba Blue Lemonade","Jammin' Blackberry Tea","Wild Strawberry Lemonade","Mango Madness Tea"] },
        { name: "Soft Drink", variants: ["Coke","Diet Coke","Dr Pepper","Diet Dr Pepper","Sprite","Barq's Root Beer"] },
        { name: "Coffee" },
        { name: "Red Bull", details: "Ask for available flavors" }
      ]
    }
  }
];

// ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let state = {
  name: "",
  currentRestaurant: null,
  cart: [],        // { name, variant, qty, restaurant }
  currentCat: "",
  returnToHub: false
};

// ‚îÄ‚îÄ‚îÄ SCREEN NAVIGATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showScreen(id, stepNum) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('.step').forEach((s, i) => {
    s.classList.remove('active', 'done');
    if (i + 1 < stepNum) s.classList.add('done');
    if (i + 1 === stepNum) s.classList.add('active');
  });
}

// ‚îÄ‚îÄ‚îÄ SCREEN 1: NAME ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function startOrder() {
  const name = document.getElementById('nameInput').value.trim();
  if (!name) {
    document.getElementById('nameInput').focus();
    document.getElementById('nameInput').style.borderColor = 'var(--accent2)';
    return;
  }
  state.name = name;
  state.cart = [];
  state.currentRestaurant = null;
  updateCartCount();
  buildRestaurantScreen();
  showScreen('screenRestaurant', 2);
}

// ‚îÄ‚îÄ‚îÄ SCREEN 2: RESTAURANT HUB ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function buildRestaurantScreen() {
  document.getElementById('greetingSub').textContent =
    `Hi ${state.name}! Pick a restaurant to browse ‚Äî you can order from multiple.`;
  const grid = document.getElementById('restaurantGrid');
  grid.innerHTML = '';

  // Cart summary per restaurant if items already in cart
  const cartByRest = {};
  state.cart.forEach(i => {
    cartByRest[i.restaurant] = (cartByRest[i.restaurant] || 0) + i.qty;
  });

  RESTAURANTS.forEach(r => {
    const itemCount = cartByRest[r.name] || 0;
    const card = document.createElement('div');
    card.className = 'restaurant-card';
    card.innerHTML = `
      <div>
        <div class="restaurant-name">${r.name}</div>
        <div class="restaurant-desc">${r.desc}</div>
        ${itemCount > 0 ? `<div style="margin-top:6px;font-size:12px;color:var(--green);font-weight:600;">‚úì ${itemCount} item${itemCount>1?'s':''} in cart</div>` : ''}
      </div>
      <div class="restaurant-arrow">‚Üí</div>
    `;
    card.onclick = () => selectRestaurant(r.id);
    grid.appendChild(card);
  });

  // Show "Review Cart" button if cart has items
  let reviewBtn = document.getElementById('hubReviewBtn');
  if (!reviewBtn) {
    reviewBtn = document.createElement('button');
    reviewBtn.id = 'hubReviewBtn';
    reviewBtn.className = 'btn-primary';
    reviewBtn.style.marginTop = '24px';
    reviewBtn.onclick = goToCart;
    grid.parentNode.appendChild(reviewBtn);
  }
  const totalItems = state.cart.reduce((s,i) => s+i.qty, 0);
  if (totalItems > 0) {
    reviewBtn.textContent = `Review Cart (${totalItems} item${totalItems>1?'s':''}) ‚Üí`;
    reviewBtn.style.display = 'block';
  } else {
    reviewBtn.style.display = 'none';
  }
}

function selectRestaurant(id) {
  state.currentRestaurant = RESTAURANTS.find(r => r.id === id);
  state.returnToHub = true;
  buildMenuScreen();
  showScreen('screenMenu', 2);
}

// ‚îÄ‚îÄ‚îÄ SCREEN 3: MENU ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function buildMenuScreen() {
  const r = state.currentRestaurant;
  document.getElementById('menuTitle').textContent = r.name;
  const cats = Object.keys(r.categories);
  state.currentCat = cats[0];

  // Build tabs
  const tabsEl = document.getElementById('catTabs');
  tabsEl.innerHTML = '';
  cats.forEach(cat => {
    const tab = document.createElement('button');
    tab.className = 'cat-tab' + (cat === state.currentCat ? ' active' : '');
    tab.textContent = cat;
    tab.onclick = () => switchCategory(cat);
    tabsEl.appendChild(tab);
  });

  renderMenuItems();
}

function switchCategory(cat) {
  state.currentCat = cat;
  document.querySelectorAll('.cat-tab').forEach(t => {
    t.classList.toggle('active', t.textContent === cat);
  });
  renderMenuItems();
}

function renderMenuItems() {
  const items = state.currentRestaurant.categories[state.currentCat];
  const content = document.getElementById('menuContent');
  content.innerHTML = '';

  let currentGroup = null;
  const container = document.createElement('div');
  container.className = 'menu-items';

  items.forEach((item, idx) => {
    if (item.group && item.group !== currentGroup) {
      currentGroup = item.group;
      const gl = document.createElement('div');
      gl.className = 'group-label';
      gl.textContent = currentGroup;
      container.appendChild(gl);
    }

    const el = document.createElement('div');
    el.className = 'menu-item';
    const itemId = `item_${state.currentCat}_${idx}`.replace(/\s/g,'_');

    el.innerHTML = `
      <div class="item-top">
        <div>
          <div class="item-name">${item.name}</div>
          ${item.details ? `<div class="item-details">${item.details}</div>` : ''}
        </div>
        <div class="item-actions">
          <button class="qty-btn" onclick="changeQty('${itemId}', -1)">‚àí</button>
          <span class="qty-display" id="qty_${itemId}">1</span>
          <button class="qty-btn" onclick="changeQty('${itemId}', 1)">+</button>
          <button class="add-btn" id="addbtn_${itemId}" onclick="addToCart('${itemId}', '${escapeStr(item.name)}')">Add</button>
        </div>
      </div>
      ${item.variants ? `
        <select class="variant-select" id="var_${itemId}">
          <option value="">‚Äî Select option ‚Äî</option>
          ${item.variants.map(v => `<option value="${v}">${v}</option>`).join('')}
        </select>
      ` : ''}
    `;
    container.appendChild(el);
  });

  content.appendChild(container);
}

function escapeStr(s) { return s.replace(/'/g, "\\'").replace(/"/g, '&quot;'); }

function changeQty(itemId, delta) {
  const el = document.getElementById(`qty_${itemId}`);
  let val = parseInt(el.textContent) + delta;
  if (val < 1) val = 1;
  if (val > 20) val = 20;
  el.textContent = val;
}

function addToCart(itemId, itemName) {
  const qtyEl = document.getElementById(`qty_${itemId}`);
  const varEl = document.getElementById(`var_${itemId}`);
  const btn = document.getElementById(`addbtn_${itemId}`);
  const qty = parseInt(qtyEl.textContent);
  const variant = varEl ? varEl.value : '';

  if (varEl && !variant) {
    varEl.style.borderColor = 'var(--accent2)';
    varEl.focus();
    return;
  }
  if (varEl) varEl.style.borderColor = '';

  state.cart.push({ name: itemName, variant, qty, restaurant: state.currentRestaurant.name });
  updateCartCount();

  btn.textContent = '‚úì Added';
  btn.classList.add('added');
  setTimeout(() => {
    btn.textContent = 'Add';
    btn.classList.remove('added');
  }, 1500);
}

function updateCartCount() {
  const total = state.cart.reduce((sum, i) => sum + i.qty, 0);
  document.getElementById('cartCount').textContent = total;
}

// ‚îÄ‚îÄ‚îÄ SCREEN 4: CART ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function goToCart() {
  const rests = [...new Set(state.cart.map(i => i.restaurant))];
  document.getElementById('cartRestLabel').textContent =
    rests.length > 0 ? rests.join(' ¬∑ ') : '';
  renderCart();
  showScreen('screenCart', 3);
}

function renderCart() {
  const list = document.getElementById('cartList');
  if (state.cart.length === 0) {
    list.innerHTML = '<div class="empty-cart">Your cart is empty.<br>Go back and add some items!</div>';
    document.getElementById('submitBtn').disabled = true;
    return;
  }
  document.getElementById('submitBtn').disabled = false;
  list.innerHTML = '';

  // Group by restaurant
  const restaurants = [...new Set(state.cart.map(i => i.restaurant))];
  restaurants.forEach(restName => {
    const header = document.createElement('div');
    header.className = 'group-label';
    header.style.marginTop = '16px';
    header.textContent = restName;
    list.appendChild(header);

    state.cart.forEach((item, idx) => {
      if (item.restaurant !== restName) return;
      const el = document.createElement('div');
      el.className = 'cart-item';
      el.innerHTML = `
        <div class="cart-item-info">
          <div class="cart-item-name">${item.name}</div>
          ${item.variant ? `<div class="cart-item-variant">${item.variant}</div>` : ''}
          <div class="cart-item-qty">Qty: ${item.qty}</div>
        </div>
        <button class="remove-btn" onclick="removeFromCart(${idx})">‚úï</button>
      `;
      list.appendChild(el);
    });
  });

  // Add "Browse More" button to go back to restaurant hub
  const browseBtn = document.createElement('button');
  browseBtn.className = 'btn-secondary';
  browseBtn.style.marginTop = '8px';
  browseBtn.textContent = '+ Add from another restaurant';
  browseBtn.onclick = () => { buildRestaurantScreen(); showScreen('screenRestaurant', 2); };
  list.appendChild(browseBtn);
}

function removeFromCart(idx) {
  state.cart.splice(idx, 1);
  updateCartCount();
  renderCart();
}

function goBack() {
  if (state.returnToHub) {
    buildRestaurantScreen();
    showScreen('screenRestaurant', 2);
  } else {
    showScreen('screenMenu', 2);
  }
}

// ‚îÄ‚îÄ‚îÄ SUBMIT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function submitOrder() {
  if (state.cart.length === 0) return;

  const notes = document.getElementById('notesInput').value.trim();

  // Group cart by restaurant ‚Äî one payload per restaurant
  const restaurants = [...new Set(state.cart.map(i => i.restaurant))];
  const payloads = restaurants.map(restName => {
    const items = state.cart.filter(i => i.restaurant === restName);
    const orderItemsText = items
      .map(i => `${i.name}${i.variant ? ' ‚Äî ' + i.variant : ''} (qty: ${i.qty})`)
      .join('\n');
    return {
      employeeName: state.name,
      restaurant: restName,
      orderItems: orderItemsText,
      specialInstructions: notes,
      orderSummary: `${state.name} ‚Äî ${restName}`
    };
  });

  document.getElementById('submitBtn').style.display = 'none';
  document.getElementById('submitLoading').style.display = 'block';

  try {
    if (POWER_AUTOMATE_URL === "YOUR_POWER_AUTOMATE_URL_HERE") {
      await new Promise(r => setTimeout(r, 1200));
    } else {
      // Fire one request per restaurant ‚Äî each creates its own SharePoint row
      await Promise.all(payloads.map(payload =>
        fetch(POWER_AUTOMATE_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        })
      ));
    }
    showConfirmation(payloads);
  } catch(e) {
    showConfirmation(payloads);
  }
}

function showConfirmation(payloads) {
  const summary = document.getElementById('orderSummary');
  let html = `<div class="order-summary-label">Order submitted for ${payloads[0].employeeName}</div>`;
  payloads.forEach(payload => {
    const lines = payload.orderItems.split('\n');
    html += `<div class="group-label" style="margin:14px 0 8px">${payload.restaurant}</div>`;
    html += lines.map(l => `<div class="order-summary-line">${l}</div>`).join('');
  });
  if (payloads[0].specialInstructions) {
    html += `<div class="order-summary-line" style="margin-top:8px"><span class="summary-variant">Note: ${payloads[0].specialInstructions}</span></div>`;
  }
  summary.innerHTML = html;
  showScreen('screenDone', 4);
  document.getElementById('submitBtn').style.display = 'block';
  document.getElementById('submitLoading').style.display = 'none';
}

function newOrder() {
  const savedName = state.name;
  state = { name: savedName, currentRestaurant: null, cart: [], currentCat: "", returnToHub: false };
  document.getElementById('nameInput').value = savedName;
  document.getElementById('notesInput').value = '';
  updateCartCount();
  buildRestaurantScreen();
  showScreen('screenRestaurant', 2);
}
</script>
</body>
</html>